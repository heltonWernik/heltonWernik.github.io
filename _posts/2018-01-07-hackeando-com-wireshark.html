---
layout: post
title: Hackeando com Wireshark
date: '2018-01-07T02:28:00.000-08:00'
author: Israel Helton Wernik
tags: 
modified_time: '2018-02-04T03:24:08.677-08:00'
thumbnail: https://3.bp.blogspot.com/-Plxatwx5R6M/WnbtUIejkeI/AAAAAAAAAFY/LtB2pthfUWoFzbJ9qbmzadjKZ6vtG_6agCLcBGAs/s72-c/barbatana-tubara%25CC%2583o2.jpg
blogger_id: tag:blogger.com,1999:blog-5213248075369348047.post-1746828130465436739
blogger_orig_url: https://cibersegurancawernik.blogspot.com/2018/02/hackeando-com-wireshark.html
---

<div dir="ltr" style="line-height: 1.38; margin-bottom: 3pt; margin-top: 0pt;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 3pt; margin-top: 0pt;"><div class="separator" style="clear: both; text-align: center;"><a href="https://3.bp.blogspot.com/-Plxatwx5R6M/WnbtUIejkeI/AAAAAAAAAFY/LtB2pthfUWoFzbJ9qbmzadjKZ6vtG_6agCLcBGAs/s1600/barbatana-tubara%25CC%2583o2.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="410" data-original-width="628" height="208" src="https://3.bp.blogspot.com/-Plxatwx5R6M/WnbtUIejkeI/AAAAAAAAAFY/LtB2pthfUWoFzbJ9qbmzadjKZ6vtG_6agCLcBGAs/s320/barbatana-tubara%25CC%2583o2.jpg" width="320" /></a></div><span style="font-family: &quot;arial&quot;; font-size: 20pt; white-space: pre-wrap;"><br /></span><span style="font-family: &quot;arial&quot;; font-size: 20pt; white-space: pre-wrap;">Capturando senha e Login</span><br /><span style="font-family: &quot;arial&quot;; font-size: 20pt; white-space: pre-wrap;"><br /></span></div><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Caso você esteja com Men In The middle ou Fake Access Point é possível também conseguir Senhas e abrir o Cookie de login do Alvo utilizando o Wireshark </span></div><span id="docs-internal-guid-c1a73f89-605b-ae33-cd0e-bc062030389e"></span><br /><a name='more'></a><span id="docs-internal-guid-c1a73f89-605b-ae33-cd0e-bc062030389e"><br /></span><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Para achar o Login e Senha deve-se filtrar por http e procurar POST</span></div><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><img height="195" src="https://lh4.googleusercontent.com/NP0qAv4GjzPUAv4XH8xHSy_MoeYz65OSTeeroeymADQYHfbAYiKG3KYLEsVpc9w2bt0GhP71Hl8fE6BtwdmD0XDKz_wNQl-IhEC3MMJsxSkn4iPwJ-gkyB67dDsXlT5iNfQX1QgW" style="border: none; transform: rotate(0rad);" width="602" /></span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Abrindo os dados pode-se ver o login e senha</span></div><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><img height="301" src="https://lh3.googleusercontent.com/6ybe4zIvR9H6PXRMqiFA2ZOtNXzHnJtVequkNwpAxi48H6CGfuCcSLiyYTljzG9hW7f0ZRf9X3U65craEfIu1cSWI5ElWVsbTTf8B7mFvLDn3fPKoiH-OLGvvryXOpeEuzUwVqwV" style="border: none; transform: rotate(0rad);" width="602" /></span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Outra forma de pesquisar é ir em Edit - Find Packet (ou control+F) </span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><img height="59" src="https://lh3.googleusercontent.com/3kz_8eFNQz9Po26ls4QdZ2ff-rpW5KuDMdCsLZLqflCfN5TgPSnYPrkTYRhpEcbsSg1cfZQ1DXUGgW8dh4kIytXP30RhaYnjAdm58IrEs2g_TLqP6fLWIquIRp_pqMNh1NQl7Bdl" style="border: none; transform: rotate(0rad);" width="602" /></span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Mudar para Packet Details e String - Você pode procurar pelo nome do login se souber ou por outro texto que lhe envie direto para o packet em que tenha o Login e Senha.</span></div><br /><h1 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 20pt;"><span style="font-family: &quot;arial&quot;; font-size: 20pt; font-weight: 400; vertical-align: baseline; white-space: pre-wrap;">Capturando Cookies </span></h1><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Se o alvo estiver conectado com algum cookie em um site também é possível capturar igual quando vimos com o hamster no artigo de men in the middle</span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Para isso só precisa filtrar por </span><span style="font-family: &quot;arial&quot;; font-size: 11pt; font-weight: 700; vertical-align: baseline; white-space: pre-wrap;">http.cookie</span></div><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Depois procura em qual packet foi acessado ao site e o POST de antes terá o Cookie.</span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><img height="176" src="https://lh5.googleusercontent.com/KvBPQDiM7iJ2LjGy5170rq0BKfQf-RQDc_TpYpnRxM-GHPmC36cfA_3vOT4k0lvmTVS7ZLvbYO-nspblChzhhhQEiXsj9OovPmH02of4sZ6az6wQksWvVxqLIN1UML22p0mRxjuJ" style="border: none; transform: rotate(0rad);" width="602" /></span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Basicamente, o que você faz é extrair cookies de um arquivo de pcap no Wireshark e injetá-lo no navegador através de uma ferramenta, por exemplo GreaseMonkey (</span><a href="http://caleudum.com/cookie-injection-with-greasemonkey/" style="text-decoration-line: none;"><span style="color: #1155cc; font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">http://caleudum.com/cookie-injection-with-greasemonkey/</span></a><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">) e você estará logado na conta.</span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="background-color: white; color: #29303b; font-family: &quot;arial&quot;; font-size: 10pt; vertical-align: baseline; white-space: pre-wrap;">Cookies manager para firefox é um ótimo plugin para isso</span></div><br /><h1 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 20pt;"><span style="font-family: &quot;arial&quot;; font-size: 20pt; font-weight: 400; vertical-align: baseline; white-space: pre-wrap;">Detectando tráfego Suspeito Com Wireshark </span></h1><span id="docs-internal-guid-5b969960-6086-997b-1a70-f8365aa9524c"><br /></span><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Antes precisa ir em </span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; font-weight: 700; vertical-align: baseline; white-space: pre-wrap;">Edit - Preferences (Ctrl+Shift+P) - Protocols - ARP/RARP</span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Ativar a opção "Detect ARP request storms"</span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><img height="242" src="https://lh6.googleusercontent.com/G9nIwgeqrywAWPNv-vEErg6kzu4CtHveB556zChGFk2LZDKzx6qB5BuqrHsIhBf1ulCbbfILEMctHqg9Q1tZhduBFoHkHmAlZNg0P9gwmPVsH-XSMBFFvQ57eiuz17SAnfRt7pdz" style="border: none; transform: rotate(0rad);" width="336" /></span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Quando o Hacker faz um comando de análise como o netdiscover que verifica tudo que está conectado na rede o resultado será:</span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><img height="271" src="https://lh4.googleusercontent.com/EyriO7ZMVds1iQXLCnZE5h1VwIIPxfcLx9psJhPov6v-ALgbf8_52mm3zWEbU5bt4wAinTIjf99RGKO0-T8mlKqPNGPR2oTEl14czMmq57v8sudwXJCXnyg_eSZGukVTSu1LIWwS" style="border: none; transform: rotate(0rad);" width="602" /></span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Podemos ver que tem um broadcast que envia a todos perguntando who has para todos os IPs possíveis.</span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Agora vá até </span><span style="font-family: &quot;arial&quot;; font-size: 11pt; font-weight: 700; vertical-align: baseline; white-space: pre-wrap;">Analyze - Expert Information</span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"> </span><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><img height="221" src="https://lh4.googleusercontent.com/QVgcGl3xbqAV4Xx2UdL-7UPEzmr_cHYkkhgR8z4dzq-QURHEHQBGIT5AwdVZvORWKqDUmG0d3qOaLoeDkANrVPozIQjZmQ0lINKQoZvwL6rVgxU1yuoVFBBCDqT37jWs87wJOfHE" style="border: none; transform: rotate(0rad);" width="602" /></span></div><br /><br /><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><img height="637" src="https://lh4.googleusercontent.com/U9Q82gFvc2Tvoywtr2koEuEUyLway4LYQOOz16f83pHrcL6C25HfIrPO8GDlrvWacpaqmyzLB0OGnr93CvkHgIzNskIkPBgKgm-L2Ju8PPLv1p0nxgDVuNX6v-bEqswNCmumbrcg" style="border: none; transform: rotate(0rad);" width="602" /></span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Podemos ver que há um ARP Storm Detected, que é um único dispositivo enviando pedidos ARP para vários outros dispositivos o que pode ser um Netdiscover. Veriamos algo assim também se estivessem procurando por portas abertas.</span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Se o Hacker fez um MITM podemos perceber um Warm Duplicate IP address Configured o que significa que um mesmo IP tem dois MAC Address diferentes. </span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><img height="144" src="https://lh4.googleusercontent.com/soPxOnZheVJhSOXKCK-Eg2Ow7REZlFFgLd65u3myUqmAj2STI_J6py8cTVbD2-FR5FkVVVbzGnWC1TlVMm76RXTC0R8NUynjRwCOc5ddqnsmhyf8enKo0nixqTjxQD2HV6ADYF5M" style="border: none; transform: rotate(0rad);" width="602" /></span></div><br /><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Cores do Wireshark:</span></div><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Green - TCP Traffic</span></div><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Dark Blue - DNS Traffic</span></div><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Light Blue - UDP Traffic</span></div><br /><div></div><br /><div dir="ltr" style="-webkit-text-stroke-width: 0px; color: black; font-family: Times; font-size: medium; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; letter-spacing: normal; line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt; orphans: 2; text-align: start; text-decoration-color: initial; text-decoration-style: initial; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><div style="margin: 0px;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Black - TCP packets com problemas </span></div></div></div>